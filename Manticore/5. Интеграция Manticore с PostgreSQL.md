### Шаг 1: Создание базы данных PostgreSQL

1. **Создадим базу данных и таблицу в PostgreSQL**. В нашем примере создадим таблицу `articles`, которая будет содержать статьи с заголовками и содержимым.

Запустим PostgreSQL и выполним следующие команды для создания базы данных и таблицы:

```SQL
-- Создаем базу данных
CREATE DATABASE manticore_demo;

-- Подключаемся к базе
\c manticore_demo;

-- Создаем таблицу для статей
CREATE TABLE articles (
    id SERIAL PRIMARY KEY,
    title VARCHAR(255),
    content TEXT
);

-- Вставим несколько примеров данных
INSERT INTO articles (title, content)
VALUES
('Статья 1', 'Это пример первой статьи о Manticore и PostgreSQL.'),
('Статья 2', 'Полнотекстовый поиск в Manticore и его применение.'),
('Статья 3', 'Использование PostgreSQL для хранения данных.');
```

Теперь у нас есть база данных с таблицей статей.

### Шаг 2: Установка Manticore

На следующем шаге нужно установить и настроить Manticore. Установка может быть выполнена с помощью стандартных менеджеров пакетов, таких как `apt` на Ubuntu или `yum` на CentOS:

```Bash
sudo apt install manticore
```

### Шаг 3: Настройка Manticore для работы с PostgreSQL

Теперь нужно настроить Manticore для индексации данных из таблицы `articles` в PostgreSQL.

1. Открываем файл конфигурации Manticore, который обычно находится по пути `/etc/manticoresearch/manticore.conf`.
    
2. Добавляем источник данных (source), который будет забирать данные из PostgreSQL:

```plaintext
source articles_source {
    type          = pgsql
    sql_host      = localhost
    sql_user      = postgres
    sql_pass      = your_password_here
    sql_db        = manticore_demo
    sql_port      = 5432
    sql_query     = \
        SELECT id, title, content FROM articles;
}
```

3. Настроим индекс для статей:

```plaintext
index articles_index {
    source        = articles_source
    path          = /var/lib/manticore/articles_index
}
```

Этот индекс будет хранить данные из таблицы `articles`, загруженные с помощью нашего источника `articles_source`.

4. После добавления этих настроек сохраняем файл конфигурации и запускаем или перезапускаем Manticore:

```Bash
sudo systemctl restart manticore
```

### Шаг 4: Индексация данных

Теперь нужно создать индекс на основе данных из PostgreSQL. Запустим команду для индексации данных:

```bash
indexer --all
```

Эта команда создаст индекс на основе данных из таблицы `articles`.

### Шаг 5: Выполнение поиска

Теперь мы можем выполнять полнотекстовый поиск по проиндексированным данным. Для этого нужно использовать SQL-подобные запросы в Manticore.

Пример поиска статей, которые содержат слово "Manticore":

```sql
mysql -h0 -P9306

SELECT * FROM articles_index WHERE MATCH('Manticore');
```

### Почему используется `mysql`?

Manticore предоставляет SQL-подобный язык запросов, и, чтобы упростить взаимодействие, можно использовать клиент MySQL для выполнения этих запросов. Это связано с тем, что в Manticore SQL-подобный синтаксис, и многие привычные для MySQL команды подходят для работы с движком.

Поэтому, чтобы подключиться к Manticore и выполнять запросы, используется команда:

```bash
mysql -h0 -P9306
```

Здесь:

- `-h0` указывает на хост (локальный сервер).
- `-P9306` — это порт, на котором работает Manticore (по умолчанию 9306).

Далее вы просто используете SQL-подобные команды для выполнения запросов в Manticore.

### Альтернатива

Если вам не хочется использовать клиент `mysql`, вы можете подключаться к Manticore через другие инструменты или клиенты, поддерживающие работу с SQL-запросами, такие как:

- **PHP MySQLi/PDO** для интеграции в веб-приложение.
- **SphinxQL CLI** — аналогичный клиент для выполнения запросов.

### Ожидаемый результат:

Если у нас в базе данных PostgreSQL были следующие статьи:

```SQL
INSERT INTO articles (title, content)
VALUES
('Статья 1', 'Это пример первой статьи о Manticore и PostgreSQL.'),
('Статья 2', 'Полнотекстовый поиск в Manticore и его применение.'),
('Статья 3', 'Использование PostgreSQL для хранения данных.');
```

То запрос вернет все статьи, которые содержат слово "Manticore" в тексте или заголовке.

Пример ответа, который может быть возвращен:

|id|title|content|
|---|---|---|
|1|Статья 1|Это пример первой статьи о Manticore и PostgreSQL.|
|2|Статья 2|Полнотекстовый поиск в Manticore и его применение.|
### Шаг 6: Настройка периодической индексации (опционально)

Чтобы поддерживать актуальность индексов, можно настроить периодическую индексацию. Например, можно настроить cron-задание для обновления индекса каждый час:

```bash
0 * * * * indexer --rotate articles_index
```

Это задание будет выполнять обновление индекса каждый час, обеспечивая актуальность данных.

### Итог

Теперь Manticore работает с базой данных PostgreSQL, индексирует статьи и позволяет выполнять полнотекстовый поиск по данным. Вы можете легко расширить эту конфигурацию для более сложных данных и настроить дополнительные индексы для других таблиц, если потребуется.