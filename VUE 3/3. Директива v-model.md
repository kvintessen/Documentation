Директива `v-model` в Vue используется для создания **двусторонней привязки данных** между элементом интерфейса (например, полем ввода, чекбоксом) и реактивным свойством компонента. Это одна из самых мощных и удобных функций Vue, поскольку позволяет автоматически синхронизировать данные между элементом и моделью.

### Основные принципы работы `v-model`

1. **Двусторонняя привязка**:
    
    - `v-model` связывает данные из компонента с элементом интерфейса (например, `<input>`). Когда пользователь изменяет значение элемента, соответствующие данные в компоненте обновляются автоматически. Аналогично, если данные в компоненте меняются, интерфейс обновляется.
2. **Управление вводом**:
    
    - Директива `v-model` автоматически отслеживает события ввода и изменения состояния элементов формы, таких как текстовые поля, чекбоксы, радио-кнопки, селекты и т.д.

Пример базовой работы `v-model`:

```TS
<template>
  <div>
    <input v-model="message" placeholder="Введите сообщение" />
    <p>Вы ввели: {{ message }}</p>
  </div>
</template>

<script>
export default {
  data() {
    return {
      message: ''
    };
  }
};
</script>
```

В этом примере:

- Данные из поля ввода автоматически синхронизируются с реактивным свойством `message` в компоненте.
- Как только пользователь изменит текст в поле ввода, значение `message` обновится, и в реальном времени отобразится в параграфе.

### Как работает `v-model` на различных элементах

#### 1. **Текстовые поля (`<input type="text">`)**

Для текстовых полей `v-model` связывает значение текста с реактивным свойством:

```TS
<input v-model="username" placeholder="Введите имя пользователя" />
```

- Когда пользователь вводит текст, реактивное свойство `username` обновляется.
- Если свойство `username` изменяется в коде, текстовое поле автоматически отобразит новое значение.

#### 2. **Чекбоксы (`<input type="checkbox">`)**

Для чекбоксов `v-model` связывает состояние чекбокса (отмечен или не отмечен) с реактивным свойством типа `boolean`.

```TS
<input type="checkbox" v-model="isChecked" />
<p>Чекбокс {{ isChecked ? 'отмечен' : 'не отмечен' }}</p>
```

- Если чекбокс отмечен, значение `isChecked` будет `true`, если нет — `false`.

#### 3. **Группа чекбоксов с массивом**

Если используется группа чекбоксов, можно привязать массив, который будет содержать все отмеченные значения:

```TS
<div>
  <input type="checkbox" v-model="selectedItems" value="item1" /> Item 1
  <input type="checkbox" v-model="selectedItems" value="item2" /> Item 2
  <input type="checkbox" v-model="selectedItems" value="item3" /> Item 3
</div>
<p>Выбранные элементы: {{ selectedItems }}</p>
```

- Каждый раз, когда пользователь отмечает или снимает чекбокс, массив `selectedItems` обновляется, добавляя или удаляя значения в зависимости от состояния чекбоксов.

#### 4. **Радио-кнопки (`<input type="radio">`)**

Для радио-кнопок `v-model` используется для выбора одного из значений:

```TS
<input type="radio" v-model="picked" value="Option 1" /> Option 1
<input type="radio" v-model="picked" value="Option 2" /> Option 2
<p>Вы выбрали: {{ picked }}</p>
```

#### 5. **Выпадающий список (`<select>`)**

`v-model` также можно использовать с выпадающими списками для привязки выбранного значения.

```TS
<select v-model="selected">
  <option disabled value="">Выберите вариант</option>
  <option value="A">A</option>
  <option value="B">B</option>
  <option value="C">C</option>
</select>
<p>Вы выбрали: {{ selected }}</p>
```

- При выборе опции `v-model` обновляет переменную `selected`, которая хранит выбранное значение.

#### 6. **Текстовая область (`<textarea>`)**

Текстовая область работает аналогично текстовому полю:

```TS
<textarea v-model="description" placeholder="Введите описание"></textarea>
<p>Описание: {{ description }}</p>
```

- Поле `description` автоматически обновляется при вводе текста.

### Настройка поведения `v-model`

В некоторых случаях нужно настраивать поведение `v-model`, например, изменять события, на которые он реагирует, или изменять формат передаваемых данных.

#### 1. **Использование модификаторов `lazy`, `number`, и `trim`**

- **`lazy`**: По умолчанию `v-model` синхронизирует данные при каждом изменении (вводе) пользователя. Если нужно синхронизировать данные только при завершении ввода (когда поле теряет фокус), можно использовать модификатор `lazy`.

```TS
<input v-model.lazy="message" placeholder="Введите сообщение" />
```

- **`number`**: Преобразует введенное значение в число.

```TS
<input v-model.number="age" placeholder="Введите возраст" />
```

- **`trim`**: Удаляет лишние пробелы в начале и конце строки.

```TS
<input v-model.trim="name" placeholder="Введите имя" />
```

#### 2. **Создание пользовательского компонента с `v-model`**

Vue позволяет настроить работу `v-model` для пользовательских компонентов, так что `v-model` будет работать с ними так же, как с обычными элементами формы. Для этого нужно использовать специальную обработку событий `update:modelValue`.

##### Пример пользовательского компонента:

```TS
<template>
  <input :value="modelValue" @input="$emit('update:modelValue', $event.target.value)" />
</template>

<script>
export default {
  props: ['modelValue']
};
</script>
```

Использование в родительском компоненте:

```TS
<MyInput v-model="username" />
```

Здесь:

- **`modelValue`** — это пропс, который получает текущее значение.
- **`update:modelValue`** — это событие, которое отправляется, когда значение изменяется.

### Особенности `v-model` в Vue 3

В Vue 3 произошли изменения в работе с `v-model`. Если в Vue 2 использовалось свойство `value` и событие `input` для обработки данных, то в Vue 3 логика изменилась на работу с `modelValue` и событие `update:modelValue`.

- Теперь для пользовательских компонентов используется `modelValue`, а не `value`.
- Вместо события `input` используется событие `update:modelValue`.

Пример:

```TS
<template>
  <input :value="modelValue" @input="$emit('update:modelValue', $event.target.value)" />
</template>

<script>
export default {
  props: {
    modelValue: String
  }
};
</script>
```

### Заключение

Директива `v-model` — это мощный инструмент для управления данными в Vue.js. Она автоматически связывает реактивные данные с элементами формы, такими как поля ввода, чекбоксы, радио-кнопки и выпадающие списки, позволяя эффективно синхронизировать пользовательский ввод с состоянием приложения.